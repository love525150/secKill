# secKill
秒杀系统设计

## 基本性能
- 使用springBoot内置tomcat服务器
- 请求直接返回字符串的性能为：并发数为1，吞吐量——383.4/sec；并发数为4时，吞吐量——538.9/sec
- 服务器上运行，并发数为1000时候，95%都能在10ms内返回，平均40ms；但10000并发的时候，平均就要700ms才能返回了

## 数据库版本
- 只使用数据库
- 不使用事务，c = 1时吞吐量——34.0/sec
- 使用事务，c = 1时吞吐量——16.0/sec
- 不使用事务，c = 4时吞吐量——169.0/sec
- 使用事务，c = 4时吞吐量——87.8.0/sec
- 并发情况下有可能出现重复下单的问题

## Redis加数据库版本
- 商品库存和已购买的用户存放在redis
- 数据库只记录成功购买的用户记录，因为只有一条sql，不需要事务
- c = 4时吞吐量——116.0/sec

## Redis加本地缓存加数据库，c=1000，商品数不缺
- 本地缓存商品缺货状态，在redis时延大的时候优化明显
- 写入数据库是性能瓶颈，服务器上要100ms以上， 本地跑要400ms以上
- 本地跑吞吐量只有360/sec
- 服务器跑请求平均时延500ms以上，吞吐量1263/sec
- c=10000的时候有时会跪，请求平均时延6000ms以上，吞吐量还是1500/sec

## Redis加本地缓存加数据库，c=10000，n=20000，商品数100
- 服务器跑平均时延900ms，吞吐量10000/s，属于可接受范围
- c=20000时，时延翻倍，吞吐量没有明显下降